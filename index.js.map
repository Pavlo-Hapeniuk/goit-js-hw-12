{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst PER_PAGE = 15;\n\nexport async function getImagesByQuery(query, currentPage) {\n  const API_KEY = '53374689-de9604de74fdd47daed383deb';\n\n  try {\n    const res = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: currentPage,\n        per_page: PER_PAGE,\n      },\n    });\n\n    if (!res.data.hits || res.data.hits.length === 0) {\n      iziToast.info({\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        backgroundColor: '#ef4040',\n        position: 'topRight',\n        timeout: 3000,\n      });\n      return { hits: [], totalHits: 0 };\n    }\n    return { hits: res.data.hits, totalHits: res.data.totalHits };\n  } catch {\n    iziToast.error({\n      message: `Something went wrong. Please try again later.`,\n      backgroundColor: '#ef4040',\n      position: 'topRight',\n      timeout: 4000,\n    });\n    return { hits: [], totalHits: 0 };\n  }\n}\n\nexport { PER_PAGE };\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst simplelightbox = new SimpleLightbox('.gallery-link', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 500,\n});\n\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.load-more-wrapper .loader');\n\nfunction cardTemplate({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `     \n      <li class=\"gallery-card\">\n        <a href=\"${largeImageURL}\" class=\"gallery-link\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" class=\"gallery-image\" width=\"360\" height=\"200\"/>\n        </a>\n        <div class=\"gallery-stats\">\n          <p><strong>Likes</strong> <span class=\"likes\">${likes}</span></p>\n          <p><strong>Views</strong> <span class=\"views\">${views}</span></p>\n          <p><strong>Comments</strong> <span class=\"comments\">${comments}</span></p>\n          <p><strong>Downloads</strong> <span class=\"downloads\">${downloads}</span></p>\n        </div>\n      </li>`;\n}\n\nfunction cardsTemplate(cards) {\n  return cards.map(cardTemplate).join('');\n}\n\nexport function createGallery(cards, replace = false) {\n  if (replace) {\n    gallery.innerHTML = cardsTemplate(cards);\n  } else {\n    gallery.insertAdjacentHTML('beforeend', cardsTemplate(cards));\n  }\n\n  simplelightbox.refresh();\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n  if (loader) loader.classList.remove('hidden');\n}\n\nexport function hideLoader() {\n  if (loader) loader.classList.add('hidden');\n}\n\nexport function showLoadMoreButton(loadMore) {\n  loadMore.classList.remove('hidden');\n}\n\nexport function hideLoadMoreButton(loadMore) {\n  loadMore.classList.add('hidden');\n}\n","import { getImagesByQuery, PER_PAGE } from './js/pixabay-api';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions';\nimport iziToast from 'izitoast';\n\nconst formElem = document.querySelector('.form');\nconst loadMoreBtn = document.querySelector('.js-btn-load');\n\nlet searchText;\nlet currentPage;\nlet totalPages;\n\nhideLoadMoreButton(loadMoreBtn);\n\nformElem.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  const formData = new FormData(e.target);\n  searchText = formData.get('search-text').trim();\n  currentPage = 1;\n\n  if (!searchText) {\n    iziToast.warning({\n      message: `Please, enter something!`,\n      backgroundColor: '#ef4040',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  clearGallery();\n  showLoader();\n  hideLoadMoreButton(loadMoreBtn);\n\n  try {\n    const { hits, totalHits } = await getImagesByQuery(searchText, currentPage);\n    await createGallery(hits, true);\n\n    totalPages = Math.ceil(totalHits / PER_PAGE);\n\n    if (hits.length === 0) {\n      iziToast.info({\n        message: `No results found.`,\n        backgroundColor: '#ef4040',\n        position: 'topRight',\n      });\n    } else if (currentPage >= totalPages) {\n      hideLoadMoreButton(loadMoreBtn);\n      iziToast.info({\n        message: `We're sorry, but you've reached the end of search results.`,\n        backgroundColor: '#67dadcff',\n        position: 'topRight',\n      });\n    } else {\n      showLoadMoreButton(loadMoreBtn);\n    }\n  } catch {\n    iziToast.error({\n      message: `Error! Please try again!`,\n      backgroundColor: '#ef4040',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n\n  e.target.reset();\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  currentPage += 1;\n  showLoader();\n\n  try {\n    const { hits } = await getImagesByQuery(searchText, currentPage);\n\n    if (hits.length === 0 || currentPage >= totalPages) {\n      hideLoadMoreButton(loadMoreBtn);\n      iziToast.info({\n        message: `We're sorry, but you've reached the end of search results.`,\n        backgroundColor: '#67dadcff',\n        position: 'topRight',\n      });\n    } else {\n      await createGallery(hits, false);\n\n      const gallery = document.querySelector('.gallery');\n      const cardHeight =\n        gallery.firstElementChild.getBoundingClientRect().height;\n\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n  } catch {\n    iziToast.error({\n      message: `Error! Please try again!`,\n      backgroundColor: '#ef4040',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n});\n"],"names":["PER_PAGE","getImagesByQuery","query","currentPage","API_KEY","res","axios","iziToast","simplelightbox","SimpleLightbox","gallery","loader","cardTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","cardsTemplate","cards","createGallery","replace","clearGallery","showLoader","hideLoader","showLoadMoreButton","loadMore","hideLoadMoreButton","formElem","loadMoreBtn","searchText","totalPages","hits","totalHits","cardHeight"],"mappings":"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"}